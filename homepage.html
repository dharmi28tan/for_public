<!DOCTYPE html>
<html>
<head>
	<title>Home Page</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
	<script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>
	<script>
		var app = angular.module('myApp', []);
		app.controller('myCtrl', function ($scope, $http) {
		    $http({
			  	method: 'GET',
			  	url: 'homepage.php'
		 	}).then(function mySuccess(response) {
		  	$scope.users = response.data;
		 	});
			$index = -1;
			$scope.editData = function(x){
				$scope.eid = $scope.users[x].id;
		        $scope.ename = $scope.users[x].name;
		        $scope.eemail = $scope.users[x].email;
		        $scope.eage = $scope.users[x].age;
		        $scope.egender = $scope.users[x].gender;
		        $index = x;
			}
			$scope.updateData = function(){	
				$scope.users[$index].id = $scope.eid;		
		      	$scope.users[$index].name = $scope.ename;
		      	$scope.users[$index].email = $scope.eemail;
		      	$scope.users[$index].age = $scope.eage;
		      	$scope.users[$index].gender = $scope.egender;

		      	id = $scope.users[$index].id;
		      	name = $scope.users[$index].name;
		      	email = $scope.users[$index].email;
		      	age = $scope.users[$index].age;
		      	gender = $scope.users[$index].gender;

			 	$http.post("homepage1.php",
		    		{'id':id, 'name': name,'email': email,'age': age,'gender': gender})
			 	.then(function myUpdate(response) {
			    	if (response.data.message === "success"){
				    	$scope.statuscode = response.data.status1;
				    	stat = $scope.statuscode;
				    	alert(stat);
				    }
				});
			}
		    $scope.removeData = function(x){
		    	$(document).ready(function(){
				    $("#myModal1").modal("show");
				    $("#delete").click(function(){
				    	x = $scope.users[x].id;
					    $scope.users.splice(x, 1);
					    $http.post("homepage2.php", 
	    		 			{'id': x})
					    .then(function myDelete(response) {
					     	if (response.data.message === "success"){
						    	$scope.statuscode = response.data.status1;
						    	stat = $scope.statuscode;
						    	alert(stat);
						    	window.location="homepage.html";
						    }
					  	}); 
					});
				});
			}
		});
	</script>
</head>
<body class="container">
<div class="row mt-4">
	<h2 class="pb-3 text-center">Home Page</h2> 
	<div ng-app="myApp" ng-controller="myCtrl" class="shadow-lg">
        <table class="table table-striped table-success text-center">
	      	<tr>
		        <th>Name</th>
		        <th>Email</th>
		        <th>Age</th>
		        <th>Gender</th>
		        <th>Edit/Delete</th>
		    </tr> 
		    <tr ng-repeat="x in users">
		        <td>{{x.name}}</td>
		        <td>{{x.email}}</td>
		        <td>{{x.age}}</td>
		        <td>{{x.gender}}</td>
		        <td>
	                <div ng-click="editData($index)" class="fas fa-user-edit" data-bs-toggle="modal" data-bs-target="#myModal"></div>
	                <span ng-click="removeData($index)" class="fas fa-trash"></span>
		        </td>
		    </tr>
		</table>
		<div class="modal" id="myModal">
		  	<div class="modal-dialog modal-xl">
			    <div class="modal-content text-center">
				    <div class="modal-header">
				        <h4 class="modal-title">Edit</h4>
				        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				    </div>
				    <div class="modal-body">
				        <table class="table table-striped table-success text-center">
					      	<tr>
						        <th>Name</th>
						        <th>Email</th>
						        <th>Age</th>
						        <th>Gender</th>
						    </tr> 
						    <tr>
						        <td><input type="text" ng-model="ename"></td>
						        <td><input type="email" ng-model="eemail"></td>
						        <td><input type="text" ng-model="eage"></td>
						        <td><input type="radio" value="Female" ng-model="egender" required><label>Female</label>
						        <input type="radio" value="Male" ng-model="egender"><label>Male</label></td>
						        <input type="hidden" ng-model="eid">
						    </tr>
						</table>
				    </div>
				    <div class="modal-footer">
				        <button type="button" class="btn btn-success" data-bs-dismiss="modal" ng-click="updateData()">Save</button>
				    </div>
			    </div>
		    </div>
		</div>
		<div class="modal" id="myModal1">
		  	<div class="modal-dialog">
			    <div class="modal-content text-center">
			    	<div class="text-end">
				        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				    </div>
			        <h4 class="modal-title pb-3">Delete Data</h4>
				    <p>Are you sure you wont to Delete..?</p>
				    <div class="btn-sm text-end">
					    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
				        <button type="button" class="btn btn-danger" id="delete" data-bs-dismiss="modal">Delete</button>
				    </div>
			    </div>
		    </div>
		</div>
	</div>
</div>
</body>
</html>